
## 대기열토큰 발급
1. 설명: 유저 UUID로 대기열 토큰을 발급한다.
2. 기본정보
- Endpoint ```/queue/token```
- HTTP Method ```POST```
3. Request
- HEADER ```Content-type: application/json```
- Body
```sql
{
    "user_uuid": "3f1f7c5b-7c53-4d3b-9d2b-1b3c43e9ee22"
}
```
4. Response
- HEADER ```Content-type: application/json```
- Body
```sql
// 200
{
    "token_uuid": "2d3f5c9a-5d5b-4b12-9b4a-1d9a1c0d1f77",
    "status", "WAITING",
    "sequence", "15",
    "exp_at", "2025-09-03T20:30:00Z"
}
```
```sql
// 400 Bad Request (잘못된 user_uuid)
{
  "error": "INVALID_USER",
  "message": "잘못된 사용자입니다."
}

// 429 Too Many Requests (발급 요청 과다)
{
  "error": "RATE_LIMIT",
  "message": "잘못된 요청입니다. 잠시 후 다시시도해주세요."
}
```
---
## 대기열토큰 조회
1. 설명: 대기열토큰의 발급상태를 조회한다.
2. 기본정보
- Endpoint ```/queue/token/{token_uuid}```
- HTTP Method ```GET```
3. Request
- HEADER ```Authorization: Bearer {token_uuid}```
- Parameter ```{token_uuid}```
4. Response
- HEADER ```Content-type: application/json```
- Body
```sql
// 200
{
    "token_uuid": "2d3f5c9a-5d5b-4b12-9b4a-1d9a1c0d1f77",
    "user_uuid": "3f1f7c5b-7c53-4d3b-9d2b-1b3c43e9ee22",
    "sequence": 7,
    "status": "ACTIVE",
    "exp_at": "2025-09-03T20:45:00Z"
}
```
```sql
// 404 Not Found (존재하지 않는 토큰)
{
  "error": "TOKEN_NOT_FOUND",
  "message": "존재하지 않는 토큰정보입니다."
}

// 401 Unauthorized (토큰만료)
{
  "error": "TOKEN_EXPIRED",
  "message": "토큰이 만료되었습니다."
}
```
---
## 예약가능한 콘서트의 날짜 조회
1. 설명: 예약가능한 콘서트의 날짜정보를 조회한다.
2. 기본정보
- Endpoint ```/concerts/available-dates```
- HTTP Method ```GET```
3. Request
- HEADER ```Authorization: Bearer {token_uuid}```
- Parameter ```from(시작일)``` ```to(종료일)```
4. Response
- HEADER ```Content-type: application/json```
- Body
```sql
// 200
{
    "concerts": [
    {
      "concert_id": 1,
      "name": "2025 Live in Seoul",
      "concert_dt": "2025-10-01"
    },
    {
      "concert_id": 2,
      "name": "2025 Live in Busan",
      "concert_dt": "2025-10-15"
    }
  ]
}
```
```sql
// 401 Unauthorized (토큰 없음/잘못됨)
{
  "error": "UNAUTHORIZED",
  "message": "잘못된 토큰정보입니다."
}
```
---
## 선택한 날짜의 좌석현황 조회
1. 설명: 선택한 콘서트의 좌석현황을 조회한다.
2. 기본정보
- Endpoint ```/concerts/{concert_id}/seats```
- HTTP Method ```GET```
3. Request
- HEADER ```Authorization: Bearer {token_uuid}```
- Parameter ```{concert_id}```
4. Response
- HEADER ```Content-type: application/json```
- Body
```sql
// 200
{
    "concert_id": 1,
    "seats": [
        { "seat_id": 101, "seat_no": 1,  "price": 50000, "status": "OPEN" },
        { "seat_id": 102, "seat_no": 2,  "price": 50000, "status": "HOLD" },
        { "seat_id": 103, "seat_no": 3,  "price": 50000, "status": "SOLD" }
    ]
}
```
```sql
// 404 Not Found (존재하지 않는 concert_id)
{
  "error": "CONCERT_NOT_FOUND",
  "message": "선택한 콘서트정보가 존재하지 않습니다."
}
```
---
## 좌석 임시배정
1. 설명: 선택한 좌석을 임시배정한다.
10분 내 결제되지 않으면 임시배정은 해제된다.
2. 기본정보
- Endpoint ```/reservations/hold```
- HTTP Method ```POST```
3. Request
- HEADER
```Authorization: Bearer {token_uuid}```
```Content-type: application/json```
- Body
```sql
{
    "user_uuid": "550e8400-e29b-41d4-a716-446655440000",
    "concert_id": 1,
    "seat_id": 101
}
```
4. Response
- HEADER ```Content-type: application/json```
- Body
```sql
// 200
{
    "reservation_id": 555,
    "concert_id": 1,
    "seat_id": 101,
    "seat_no": 1,
    "status": "HOLD",
    "hold_exp_at": "2025-09-03T20:40:00Z"
}
```
```sql
// 409 Conflict (이미 HOLD/SOLD 상태)
{
  "error": "SEAT_UNAVAILABLE",
  "message": "이미 선택된 좌석입니다."
}

// 400 Bad Request (잘못된 seat_id)
{
  "error": "INVALID_SEAT",
  "message": "존재하지 않는 좌석입니다."
}
```
---
## 잔액충전
1. 설명: 잔액을 일정금액 충전한다.
2. 기본정보
- Endpoint ```/points/charge```
- HTTP Method ```POST```
3. Request
- HEADER 
```Authorization: Bearer {token_uuid}```
```Content-type: application/json```
- Body
```sql
{
    "user_uuid": "3f1f7c5b-7c53-4d3b-9d2b-1b3c43e9ee22",
    "amount": 100000
}
```
4. Response
- HEADER ```Content-type: application/json```
- Body
```sql
// 200
{
    "user_uuid": "550e8400-e29b-41d4-a716-446655440000",
    "balance": 150000,
    "history": {
        "id": 321,
        "transaction_type": "CHARGE",
        "amount": 100000,
        "upd_at": "2025-09-03T21:00:00Z"
    }
}
```
```sql
// 400 Bad Request (금액이 0 이하)
{
  "error": "INVALID_AMOUNT",
  "message": "충전금액은 0원보다 커야합니다."
}
```
---
## 잔액조회
1. 설명: 현재 잔액을 조회한다.
2. 기본정보
- Endpoint ```/points/{user_uuid}```
- HTTP Method ```GET```
3. Request
- HEADER ```Authorization: Bearer {token_uuid}```
- Parameter ```{user_uuid}```
4. Response
- HEADER ```Content-type: application/json```
- Body
```sql
// 200
{
    "user_uuid": "550e8400-e29b-41d4-a716-446655440000",
    "balance": 150000,
    "upd_at": "2025-09-03T21:05:00Z"
}
```
```sql
// 404 Not Found (존재하지 않는 유저)
{
  "error": "USER_NOT_FOUND",
  "message": "존재하지 않는 사용자입니다."
}
```
---
## 결제
1. 설명: 임시배정된 좌석을 결제처리한다.
결제완료시 -> 결제내역생성, 좌석소유권 배정, 대기열토큰 만료된다
2. 기본정보
- Endpoint ```/payments/confirm```
- HTTP Method ```POST```
3. Request
- HEADER 
```Authorization: Bearer {token_uuid}```
```Content-type: application/json```
- Body
```sql
{
    "reservation_id": 555,
    "user_uuid": "550e8400-e29b-41d4-a716-446655440000",
    "amount": 120000
}
```
4. Response
- HEADER ```Content-type: application/json```
- Body
```sql
// 200
{
    "payment_id": 777,
    "reservation_id": 555,
    "user_uuid": "550e8400-e29b-41d4-a716-446655440000",
    "amount": 120000,
    "status": "CAPTURED",
    "crt_at": "2025-09-03T21:10:00Z",
    "reservation": {
        "seat_id": 101,
        "concert_id": 1,
        "status": "CONFIRMED"
    }
}
```
```sql
// 402 Payment Required (잔액 부족)
{
  "error": "INSUFFICIENT_BALANCE",
  "message": "[결제실패] 잔액이 부족합니다."
}

// 409 Conflict (예약 만료됨)
{
  "error": "RESERVATION_EXPIRED",
  "message": "[결제실패] 예약시간이 만료되었습니다."
}
```
